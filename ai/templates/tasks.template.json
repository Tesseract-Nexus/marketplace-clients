{
  "run_id": "[RUN-ID]",
  "generated_by": "codex",
  "generated_at": "YYYY-MM-DDTHH:MM:SSZ",
  "last_updated": "YYYY-MM-DDTHH:MM:SSZ",
  "last_updated_by": "codex | claude | gemini",
  "summary": {
    "total": 0,
    "p0": 0,
    "p1": 0,
    "p2": 0,
    "p3": 0,
    "completed": 0,
    "pending": 0,
    "in_progress": 0,
    "blocked": 0,
    "escalated": 0
  },
  "tasks": [
    {
      "id": "TASK-001",
      "title": "[Clear, actionable title]",
      "severity": "P0",
      "status": "pending",
      "type": "fix",
      "tag": "PR Gate",
      "source": "codex",
      "finding_ref": "F-001",
      "files": [
        "services/orders-service/handlers/order.go"
      ],
      "lines": "123-145",
      "policy_ref": "policies.md#tenant-isolation-rules",
      "description": "[Detailed description of what needs to be done and why]",
      "acceptance_criteria": [
        "Query includes WHERE tenant_id = ?",
        "Tenant ID extracted from X-Tenant-ID header",
        "Returns 400 if tenant_id is missing",
        "Unit test verifies tenant isolation"
      ],
      "tests_required": [
        "TestGetOrders_TenantIsolation",
        "TestGetOrders_MissingTenantID",
        "TestGetOrders_CrossTenantAccess"
      ],
      "notes": "[Additional context, warnings, or suggestions]",
      "created_at": "YYYY-MM-DDTHH:MM:SSZ",
      "completed_at": null,
      "implementation_notes": null,
      "escalation_reason": null,
      "escalation_details": null,
      "blocked_by": null,
      "bug_report": null
    },
    {
      "id": "TASK-002",
      "title": "[Title]",
      "severity": "P1",
      "status": "pending",
      "type": "fix",
      "tag": "PR Gate",
      "source": "codex",
      "finding_ref": "F-002",
      "files": [],
      "lines": "",
      "policy_ref": "",
      "description": "",
      "acceptance_criteria": [],
      "tests_required": [],
      "notes": "",
      "created_at": "YYYY-MM-DDTHH:MM:SSZ",
      "completed_at": null,
      "implementation_notes": null,
      "escalation_reason": null,
      "escalation_details": null,
      "blocked_by": null,
      "bug_report": null
    },
    {
      "id": "BUG-001",
      "title": "[Bug title from QA]",
      "severity": "P1",
      "status": "pending",
      "type": "bug",
      "tag": "PR Gate",
      "source": "gemini-qa",
      "finding_ref": null,
      "bug_report": "bug-reports/BUG-001.md",
      "files": [],
      "lines": "",
      "policy_ref": "",
      "description": "",
      "acceptance_criteria": [],
      "tests_required": [],
      "notes": "",
      "created_at": "YYYY-MM-DDTHH:MM:SSZ",
      "completed_at": null,
      "implementation_notes": null,
      "escalation_reason": null,
      "escalation_details": null,
      "blocked_by": null
    }
  ],
  "regression_suite": {
    "description": "3-App Journey Regression: Onboarding → Admin → Storefront",
    "test_categories": [
      {
        "name": "Tenant Isolation",
        "tag": "PR Gate",
        "tests": [
          {
            "id": "TI-001",
            "name": "Data visible only to owning tenant",
            "status": "pending",
            "services": ["orders-service", "products-service", "customers-service"]
          },
          {
            "id": "TI-002",
            "name": "Cross-tenant access denied",
            "status": "pending",
            "services": ["all tenant-scoped services"]
          },
          {
            "id": "TI-003",
            "name": "Missing tenant_id rejected with 400",
            "status": "pending",
            "services": ["all tenant-scoped services"]
          },
          {
            "id": "TI-004",
            "name": "Tenant_id in body cannot override header",
            "status": "pending",
            "services": ["all tenant-scoped services"]
          }
        ]
      },
      {
        "name": "Keycloak Authentication",
        "tag": "PR Gate",
        "tests": [
          {
            "id": "AUTH-001",
            "name": "Valid JWT token accepted",
            "status": "pending",
            "services": ["auth-bff", "all services"]
          },
          {
            "id": "AUTH-002",
            "name": "Expired JWT token rejected",
            "status": "pending",
            "services": ["auth-bff", "all services"]
          },
          {
            "id": "AUTH-003",
            "name": "Invalid signature rejected",
            "status": "pending",
            "services": ["auth-bff", "all services"]
          },
          {
            "id": "AUTH-004",
            "name": "Missing Authorization header rejected",
            "status": "pending",
            "services": ["all protected endpoints"]
          },
          {
            "id": "AUTH-005",
            "name": "Wrong realm token rejected",
            "status": "pending",
            "services": ["auth-bff"]
          }
        ]
      },
      {
        "name": "Checkout Idempotency",
        "tag": "PR Gate",
        "tests": [
          {
            "id": "IDEM-001",
            "name": "First order creation succeeds",
            "status": "pending",
            "services": ["orders-service", "payment-service"]
          },
          {
            "id": "IDEM-002",
            "name": "Duplicate request returns same order",
            "status": "pending",
            "services": ["orders-service"]
          },
          {
            "id": "IDEM-003",
            "name": "Different idempotency key creates new order",
            "status": "pending",
            "services": ["orders-service"]
          },
          {
            "id": "IDEM-004",
            "name": "Concurrent requests handled correctly",
            "status": "pending",
            "services": ["orders-service", "inventory-service"]
          },
          {
            "id": "IDEM-005",
            "name": "Payment idempotency with provider",
            "status": "pending",
            "services": ["payment-service"]
          }
        ]
      },
      {
        "name": "Onboarding Flow",
        "tag": "Extended",
        "tests": [
          {
            "id": "ONB-001",
            "name": "New tenant registration",
            "status": "pending",
            "services": ["tenant-service", "verification-service"]
          },
          {
            "id": "ONB-002",
            "name": "Email/OTP verification",
            "status": "pending",
            "services": ["verification-service", "notification-service"]
          },
          {
            "id": "ONB-003",
            "name": "Business setup wizard completion",
            "status": "pending",
            "services": ["tenant-service"]
          },
          {
            "id": "ONB-004",
            "name": "Initial admin user creation",
            "status": "pending",
            "services": ["staff-service", "auth-bff"]
          },
          {
            "id": "ONB-005",
            "name": "Keycloak realm provisioning",
            "status": "pending",
            "services": ["auth-bff", "keycloak"]
          }
        ]
      },
      {
        "name": "Admin Portal Flow",
        "tag": "Extended",
        "tests": [
          {
            "id": "ADM-001",
            "name": "Admin login via Keycloak",
            "status": "pending",
            "services": ["auth-bff", "admin app"]
          },
          {
            "id": "ADM-002",
            "name": "Tenant context loaded from subdomain",
            "status": "pending",
            "services": ["tenant-router-service", "admin app"]
          },
          {
            "id": "ADM-003",
            "name": "Product CRUD (tenant-scoped)",
            "status": "pending",
            "services": ["products-service"]
          },
          {
            "id": "ADM-004",
            "name": "Order management (tenant-scoped)",
            "status": "pending",
            "services": ["orders-service"]
          },
          {
            "id": "ADM-005",
            "name": "Staff invitation and activation",
            "status": "pending",
            "services": ["staff-service", "notification-service"]
          }
        ]
      },
      {
        "name": "Storefront Flow",
        "tag": "Extended",
        "tests": [
          {
            "id": "SF-001",
            "name": "Customer registration",
            "status": "pending",
            "services": ["customers-service", "auth-bff"]
          },
          {
            "id": "SF-002",
            "name": "Product catalog (tenant-scoped)",
            "status": "pending",
            "services": ["products-service", "search-service"]
          },
          {
            "id": "SF-003",
            "name": "Cart management",
            "status": "pending",
            "services": ["orders-service"]
          },
          {
            "id": "SF-004",
            "name": "Full checkout flow",
            "status": "pending",
            "services": ["orders-service", "payment-service", "inventory-service"]
          },
          {
            "id": "SF-005",
            "name": "Order confirmation and history",
            "status": "pending",
            "services": ["orders-service", "notification-service"]
          }
        ]
      },
      {
        "name": "Full Regression",
        "tag": "Nightly",
        "tests": [
          {
            "id": "REG-001",
            "name": "Complete onboarding to first sale journey",
            "status": "pending",
            "services": ["all"]
          },
          {
            "id": "REG-002",
            "name": "Multi-tenant concurrent operations",
            "status": "pending",
            "services": ["all tenant-scoped"]
          },
          {
            "id": "REG-003",
            "name": "Load test: checkout under load",
            "status": "pending",
            "services": ["orders-service", "payment-service"]
          },
          {
            "id": "REG-004",
            "name": "Failure recovery scenarios",
            "status": "pending",
            "services": ["all"]
          }
        ]
      }
    ]
  },
  "missing_fixtures": [
    {
      "id": "FIX-001",
      "description": "Multi-tenant test fixtures for orders-service",
      "path": "services/orders-service/testdata/",
      "needed_for": ["TI-001", "TI-002", "TI-003"],
      "status": "missing"
    },
    {
      "id": "FIX-002",
      "description": "Keycloak test tokens (valid, expired, invalid signature)",
      "path": "tests/fixtures/tokens/",
      "needed_for": ["AUTH-001", "AUTH-002", "AUTH-003"],
      "status": "missing"
    },
    {
      "id": "FIX-003",
      "description": "Checkout idempotency test data",
      "path": "services/orders-service/testdata/idempotency/",
      "needed_for": ["IDEM-001", "IDEM-002", "IDEM-003"],
      "status": "missing"
    },
    {
      "id": "FIX-004",
      "description": "Complete 3-app journey seed data",
      "path": "tests/fixtures/e2e/",
      "needed_for": ["ONB-*", "ADM-*", "SF-*"],
      "status": "missing"
    }
  ]
}
